<!doctype html>
<html>

    <head>
        <meta charset="utf-8">
        <title>Verisurf Master API Sample</title>
        <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
        <link href="index.css" rel="stylesheet">
        <!-- <link href="tailwind.css" rel="stylesheet"> -->
        <link href="node_modules/intro.js/introjs.css" rel="stylesheet">
        <link href="node_modules/intro.js/themes/introjs-modern.css" rel="stylesheet">

    </head>

    <body>
        <div id="wrapper">
            <!-- Navigation Bar -->
            <div id="sidebar-wrapper">
                <ul class="sidebar-nav">
                    <div class="list-group">
                        <a class="list-group-item active"><img class="logoStyle" src="./extraResources/logo.png"
                                aria-hidden="true" />
                        </a>
                        <p class="list-group-item border-0 h4 dividerPad">Connection Status<span></span></p>
                        <p class="list-group-item border-0 statusBar">Verisurf Status<span id="verisurfStatus"
                                class="redPulse"></span></p>
                        <p class="list-group-item border-0 vsstatusBar">API Status<span id="apiStatus"
                                class="redPulse"></span></p>
                        <p class="list-group-item border-0 h4">API Commands<span></span></p>

                        <!--? Command Section  -->

                        <a href="#" onclick="Connect();"
                            class="list-group-item list-group-item-action list-group-item-active connectButton"
                            id="connectButton">
                            <img class="linkImgStyles" src='./extraResources/connect.svg' />
                            Connect</a>
                        <a href="#" onclick="Disconnect();" id="disconnectButton"
                            class="list-group-item list-group-item-action list-group-item-active disabled disconnectHint"><img
                                class="linkImgStyles" src="./extraResources/disconnect.svg" aria-hidden="true" />
                            Disconnect</a>
                        <a href="#" onclick="FileOpen();"
                            class="list-group-item list-group-item-action list-group-item-active openHint"><img
                                class="linkImgStyles" src="./extraResources/save.svg" aria-hidden="true" />
                            File Open</a>
                        <a href="#" onclick="FileSave();"
                            class="list-group-item list-group-item-action list-group-item-active"><img
                                class="linkImgStyles" src="./extraResources/open.svg" aria-hidden="true" />
                            File Save</a>
                        <a href="#" onclick="OpenDRO();"
                            class="list-group-item droTour list-group-item-action list-group-item-active"><img
                                class="linkImgStyles" src="./extraResources/opendro.svg" aria-hidden="true" />
                            Open DRO</a>
                        <a href="#" onclick="RunTutorial();"
                            class="list-group-item droTour list-group-item-action list-group-item-active"><img
                                class="linkImgStyles" src="./extraResources/tutorial.svg" aria-hidden="true" />
                            Run Tutorial</a>
                        <p class="list-group-item border-0 versionText versionStyle" id="versionText"></p>
                    </div>
                </ul>
            </div>
            <div id="page-content-wrapper">
                <!-- ?Main Content -->
                <div class="card mb-3 shadow rounded"
                    data-hint="You can revisit the tutorial anytime by running the Tutorial button"
                    data-hintPosition="middle-left">
                    <h2 class="card-header bg-primary">Verisurf API Sample</h2>
                    <div class="card-body ">
                        <p class="card-text">This is a sample application for the Verisurf API written in Electron. The
                            navigation items on the left will issue commands to Verisurf and the area below will show
                            the response from Verisurf. You may also issue a specific command
                            through the dropdown list below.</p>
                        <textarea class="form-control textAreaStyle textAreaTour" id="results" name="results"
                            disabled></textarea>
                        <div class="input-group">
                            <div class="form-group col-md-6">
                                <label class="categoryStyle" for="categorySelect" styleclass="form-label mt-4">Select
                                    Category:</label>
                                <div class="input-group categoryTour">
                                    <select id="categorySelect" class="form-select" onchange="showCommands()"
                                        data-live-search="true">
                                        <option selected>Select Category</option>
                                        <option value="CAD">CAD</option>
                                        <option value="General">General</option>
                                        <option value="Verisurf Database">Verisurf Database</option>
                                        <option value="Device">Device</option>
                                        <option value="Measure">Measure</option>
                                        <option value="Report">Report</option>
                                        <option value="All">All</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div id="commandContainer">
                            <label class="form-label mt-4" for="inputCmd">Command:</label>
                            <div class="input-group">
                                <select class="form-select commandTour" id="command"
                                    onchange="handleCmdChange(this.value)"></select>
                                <div class="input-group-prepend">
                                    <div class="input-group-text btnMargins">ID</div>
                                </div>
                                <div class="idTour">
                                    <input type="number" value="1" class="form-control idPadding" id="paramField">
                                </div>
                                <div>
                                    <button class="btn btn-primary hiddenParam sendCommandtour btnMargins"
                                        onclick="CustomCommand();">Send Command</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- .MD Content -->
                <div class="card mb-3 shadow rounded mdTour mdContent" id="mdContent">
                    <h2 class="card-header bg-primary" id="cmdExpTitle"></h2>

                    <div class="card-body" id="mdBody">
                    </div>
                </div>
            </div>
        </div>

        <!-- ?CMM PlaceHolder Modal-->

        <div class="modal fade" id="cmmIppModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Send CMM Message</h5>
                    </div>
                    <div class="modal-body">
                        <form>
                            <div class="form-group">
                                <label for="message-text" class="col-form-label">Message:</label>
                                <textarea class="form-control" placeholder="ClearAllErrors()"
                                    id="cmmIppUserCmd"></textarea>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="cmmIppModal"
                            onClick="CloseThis(this)">Close</button>
                        <button type="button" onclick="SendIppCmd(document.getElementById('cmmIppUserCmd').value)"
                            class="btn btn-primary">Send Command</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ?Alert PlaceHolder-->

        <div id="errorAlert" aria-hidden="true" class="alert alert-danger alert-dismissible"
            style="z-index:99999; border-radius:10px;width:50%;position:absolute; display:none;transform:translate(50%, -31rem);">
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            <h4 class="alert-heading">Error</h4>
            <p class="mb-0">Unable to open the Verisurf version selected, more information may be available in the log
                file. You can try to connect again, or close this. </p>
        </div>

        <!-- ?Start Verisurf Modal-->

        <div class="modal fade" id="runMastercamModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Verisurf Not Running</h5>
                    </div>
                    <div class="modal-body">
                        <form>
                            <div class="form-group">
                                <label for="message-text" class="col-form-label">Verisurf doesn't seem to be running,
                                    would you like to open it?</label>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" onClick="CloseThis(runMastercamModal)"
                            class="btn btn-secondary">Close</button>
                        <div class="dropdown show">
                            <button id="versionSelectorBtn" type="button" class="btn btn-primary dropdown-toggle"
                                data-bs-toggle="dropdown">Launch Verisurf</button>
                            <div id="versionSelector" class="dropdown-menu" aria-labelledby="versionSelectorBtn">
                                <!-- *Version Selector Maps Here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            window['old_module'] = window['module'];
            delete window.module;
        </script>
        <script src="node_modules/intro.js/intro.js"></script>
        <script src="node_modules/jquery/dist/jquery.js"></script>
        <script src='node_modules/bootstrap/dist/js/bootstrap.bundle.js'></script>
        <script>
        var rtime;
                var timeout = false;
                var delta = 200;
                $(window).resize(function() {
                    rtime = new Date();
                    if (timeout === false) {
                        timeout = true;
                        setTimeout(resizeend, delta);
                    }
                });
                async function resizeend() {
                    if (new Date() - rtime < delta) {
                        setTimeout(resizeend, delta);
                    } else {
                        timeout = false;
                        const resized = await settings.get('stats.resized');
                        await settings.set('stats.resized', resized + 1);
                        // wasResized();
                    }               
                }

        </script>
        <script src="app.js"></script>
        <script src="apiCalls.js"></script>
        <script src="./helpers.js" type="text/javascript"> </script>
    </body>

</html>
